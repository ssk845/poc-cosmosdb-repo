---
- hosts: localhost
  vars:
    azure_config_dir: "/tmp/{{ tower_workflow_job_id }}"
  environment:
    AZURE_CONFIG_DIR: "{{ azure_config_dir }}"
 
    pre_tasks:
      - name: Verify az cli config directory is present 
        file: 
         path: "{{ azure_config_dir }}"
         state: directory
  
    tasks:
       hosts: localhost
       environment:
            AZURE_SUBSCRIPTION_ID: 6af82c96-2a41-49cd-87ad-3e385f240d38 
            AZURE_CLIENT_ID: f988b6ec-5faa-4c88-bf88-9e1beaaa2401
            AZURE_SECRET_ID: h488Q~nYAI9AasyT6LqFnVMFijKQZmsC5pXqValz
            AZURE_TENANT_ID: 61952ee6-6c0e-4a3f-8626-75162de8f019

            name: use az login
            shell: az login --service-principal --username {{ AZURE_CLIENT_ID }} --password {{ AZURE_SECRET_ID }} --tenant {{ AZURE_TENANT_ID }}